{"version":3,"file":"zoom-area.component.js","sourceRoot":"","sources":["../../src/zoom-area.component.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE,YAAY,EAA4B,MAAM,eAAe,CAAC;AAC5G,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE,OAAO,EAAE,MAAM,qBAAqB,CAAC;AACjF,OAAO,EAAE,OAAO,EAAE,OAAO,EAAY,MAAM,eAAe,CAAC;AAC3D,OAAO,EAAE,gBAAgB,EAAE,MAAM,sBAAsB,CAAC;;IAqDpD,2BACS,gBAAkC;QAAlC,qBAAgB,GAAhB,gBAAgB,CAAkB;2BAdnB,IAAI,YAAY,EAAO;4BACtB,IAAI,YAAY,EAAO;+BAGpB,IAAI,YAAY,EAAW;4BAG9B,IAAI,YAAY,EAAU;0BAmDtC;YACX,EAAE,EAAE,CAAC;YACL,EAAE,EAAE,CAAC;YACL,UAAU,EAAE,CAAC;YACb,UAAU,EAAE,CAAC;YACb,KAAK,EAAE,CAAC;YACR,KAAK,EAAE,CAAC;YACR,KAAK,EAAE,CAAC;YACR,KAAK,EAAE,CAAC;YACR,CAAC,EAAE,CAAC;YACJ,CAAC,EAAE,CAAC;YACJ,MAAM,EAAE,CAAC;YACT,MAAM,EAAE,CAAC;YACT,KAAK,EAAE,CAAC;YACR,IAAI,EAAE,CAAC;SACR;QAzDC,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC;KACnC;IAED,uCAAW,GAAX,UAAa,OAAsB;QACjC,EAAE,CAAC,CAAC,UAAU,IAAI,OAAO,CAAC,CAAC,CAAC;YAC1B,IAAI,YAAY,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;YAEvC,EAAE,CAAC,CAAC,YAAY,IAAI,YAAY,CAAC,YAAY,CAAC,CAAC,CAAC;gBAC9C,IAAI,CAAC,iBAAiB,GAAG,OAAO,CAAC;aAClC;YAAC,IAAI,CAAC,CAAC;gBACN,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC;aACnC;SACF;QAED,EAAE,CAAC,CAAC,OAAO,IAAI,OAAO,CAAC,CAAC,CAAC;YACvB,IAAI,UAAU,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;YAElC,EAAE,CAAC,CAAC,UAAU,IAAI,UAAU,CAAC,YAAY,IAAI,UAAU,CAAC,YAAY,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC3E,IAAI,CAAC,SAAS,EAAE,CAAC;aAClB;SACF;KACF;IAED,2CAAe,GAAf;QAAA,iBAiBC;QAhBC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,IAAI;YACpC,KAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;SAC1C,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;;QAGvD,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC,SAAS,CAAC,UAAA,MAAM;YACnD,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC;gBAChC,MAAM,CAAC;aACR;YAED,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;YACjC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;SACpC,CAAC,CAAC;KACJ;IAmBD,8CAAkB,GAAlB;QACE,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,KAAK,OAAO,GAAG,QAAQ,GAAG,OAAO,CAAC;KAClF;IAED,kCAAM,GAAN;QACE,IAAI,CAAC,UAAU,CAAC,KAAK,IAAI,CAAC,CAAC;QAE3B,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;SACtF;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC;SAC3B;QAED,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;KACzB;IAED,mCAAO,GAAP,UAAS,KAAM;QACb,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC;YAC1B,MAAM,CAAC;SACR;QAED,IAAI,CAAC,UAAU,CAAC,KAAK,IAAI,CAAC,CAAC;QAE3B,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC;SAC3B;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC;YAChC,KAAK,GAAG,IAAI,CAAC;YACb,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;SACpF;QAED,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAEpD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;KAC1B;IAED,qCAAS,GAAT;QACE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC;QAC1B,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC;YAC3C,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC;SAC5B;QACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KACpB;IAEO,sCAAU,GAAlB,UAAmB,GAAgB,EAAE,OAAgB;QACnD,IAAI,CAAC,eAAe,GAAG,GAAG,CAAC;QAC3B,IAAI,CAAC,OAAO,GAAG,IAAI,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAEjD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAC7C,IAAI,CAAC,GAAgB,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAC1C,IAAI,CAAC,UAAU,CAAC,EAAE,GAAG,CAAC,CAAC,WAAW,CAAC;YACnC,IAAI,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC,CAAC,YAAY,CAAC;SACtC;QAED,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC;QACvE,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC;QACxE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;QACnD,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;QACnD,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC;QAE7C,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;QACtB,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAC9C,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACpD,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,WAAW,EAAC,IAAI,CAAE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACvD,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAC9C,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAClD,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACxD,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KAC5D;IAED,iCAAK,GAAL,UAAM,EAAE;QACN,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,CAAC;SACR;QAED,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC;QACnC,IAAI,CAAC,SAAS,EAAE,CAAC;KAClB;IAED,oCAAQ,GAAR;QACE,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;QAC3C,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;KAC5C;IAED,iCAAK,GAAL,UAAM,EAAE;QACN,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;YAC1B,IAAI,KAAK,GAAG,KAAK,CAAC;YAClB,IAAI,CAAC,UAAU,CAAC,KAAK,IAAI,EAAE,CAAC;YAC5B,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC9B,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC;gBAC1B,KAAK,GAAG,IAAI,CAAC;aACd;YAED,IAAI,CAAC,SAAS,EAAE,CAAC;YACjB,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAC,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAC,CAAC,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;SAC7F;KACF;IAED,mCAAO,GAAP,UAAQ,EAAE;QACR,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,CAAC,EAAE,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,GAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAA;QAC/H,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,SAAS,EAAE,CAAC;KAClB;IAED,sCAAU,GAAV,UAAW,EAAE;QACX,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC;SAC3B;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC;SAC3B;QAED,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC;QAC7C,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,SAAS,EAAE,CAAC;KAClB;IAED,qCAAS,GAAT;QACE,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;QAC5H,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC;QAE9H,IAAI,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QAC5G,IAAI,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;QAE5F,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,QAAQ,GAAG,UAAU,CAAC;QAC3E,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,GAAG,QAAQ,CAAC;QAErC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,QAAQ,GAAG,UAAU,CAAC;QAC3E,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,GAAG,QAAQ,CAAC;QAErC,IAAI,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;KACnC;IAED,mCAAO,GAAP,UAAQ,EAAU,EAAE,EAAU;QAC5B,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC;QACzF,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,YAAY,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,YAAY,CAAC,CAAC;QAClJ,IAAI,CAAC,UAAU,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,YAAY,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,YAAY,CAAC,CAAC;KACnJ;IAED,qCAAS,GAAT,UAAU,EAAW,EAAE,EAAW;QAChC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,GAAG,kBAAe,EAAE,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,cAAO,EAAE,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,wBAAkB,IAAI,CAAC,UAAU,CAAC,KAAK,UAAK,IAAI,CAAC,UAAU,CAAC,KAAK,SAAM,CAAC;KACpL;;gBAnQJ,SAAS,SAAC;oBACV,QAAQ,EAAE,WAAW;oBACrB,QAAQ,EAAE,sxBAsBV;oBACA,UAAU,EAAE;wBACT,OAAO,CAAC,mBAAmB,EAAE;4BAC3B,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;4BACvD,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;4BACvD,UAAU,CAAC,iBAAiB,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;4BAC/C,UAAU,CAAC,iBAAiB,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;yBAChD,CAAC;qBACJ;iBACD;;;;gBAnCQ,gBAAgB;;;yBAqCpB,SAAS,SAAC,cAAc;4BACxB,SAAS,SAAC,OAAO;gCAEjB,MAAM;iCACN,MAAM;6BAEN,KAAK;oCACL,MAAM;0BAEN,KAAK;iCACL,MAAM;;4BAlDX;;SAuCa,iBAAiB","sourcesContent":["import { Component, ViewChild, Input, Output, EventEmitter, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { trigger, state, style, transition, animate } from '@angular/animations';\r\nimport { Gesture, Content, RootNode } from 'ionic-angular';\r\nimport { ZoomAreaProvider } from './zoom-area.provider';\r\n\r\n@Component({\r\n selector: 'zoom-area',\r\n template: `\r\n    <ion-content>\r\n      <div #zoomAreaRoot class=\"zoom\" (click)=\"toggleZoomControls()\">\r\n        <div class=\"fit\">\r\n          <ng-content></ng-content>\r\n        </div>\r\n      </div>\r\n\r\n      <ion-fab right top [@visibilityChanged]=\"zoomControlsState\">\r\n        <button (click)=\"zoomIn()\" ion-fab color=\"primary\" class=\"btn-zoom\">\r\n            <ion-icon name=\"add-circle\"></ion-icon>\r\n        </button>\r\n\r\n        <button (click)=\"zoomOut()\" ion-fab color=\"primary\" class=\"btn-zoom\">\r\n            <ion-icon name=\"remove-circle\"></ion-icon>\r\n        </button>\r\n\r\n        <button (click)=\"zoomReset()\" ion-fab color=\"primary\" class=\"btn-zoom\">\r\n            <ion-icon name=\"md-contract\"></ion-icon>\r\n        </button>\r\n      </ion-fab>\r\n    </ion-content>\r\n`,\r\n animations: [\r\n    trigger('visibilityChanged', [\r\n      state('shown', style({ opacity: 1, display: 'block' })),\r\n      state('hidden', style({ opacity: 0, display: 'none' })),\r\n      transition('shown => hidden', animate('300ms')),\r\n      transition('hidden => shown', animate('300ms')),\r\n    ])\r\n ]\r\n})\r\nexport class ZoomAreaComponent implements OnChanges {\r\n    @ViewChild('zoomAreaRoot') zoom;\r\n    @ViewChild(Content) content: Content;\r\n\r\n    @Output() afterZoomIn = new EventEmitter<any>();\r\n    @Output() afterZoomOut = new EventEmitter<any>();\r\n\r\n    @Input() controls: boolean;\r\n    @Output() controlsChanged = new EventEmitter<boolean>();\r\n\r\n    @Input() scale: number;\r\n    @Output() scaleChanged = new EventEmitter<number>();\r\n\r\n    zoomControlsState;\r\n    zoomRootElement;\r\n    gesture;\r\n\r\n    constructor (\r\n      public zoomAreaProvider: ZoomAreaProvider\r\n    ) {\r\n      this.zoomControlsState = 'hidden';\r\n    }\r\n\r\n    ngOnChanges (changes: SimpleChanges) {\r\n      if ('controls' in changes) {\r\n        let showControls = changes['controls'];\r\n\r\n        if (showControls && showControls.currentValue) {\r\n          this.zoomControlsState = 'shown';\r\n        } else {\r\n          this.zoomControlsState = 'hidden';\r\n        }\r\n      }\r\n\r\n      if ('scale' in changes) {\r\n        let scaleValue = changes['scale'];\r\n\r\n        if (scaleValue && scaleValue.currentValue && scaleValue.currentValue === 1) {\r\n          this.zoomReset();\r\n        }\r\n      }\r\n    }\r\n\r\n    ngAfterViewInit () {\r\n      this.content.ionScroll.subscribe((data)=>{\r\n        this.zoomAreaProvider.notifyScroll(data);\r\n      });\r\n\r\n      this._pinchZoom(this.zoom.nativeElement, this.content);\r\n\r\n      // Watch for user setCenter call\r\n      let self = this;\r\n      this.zoomAreaProvider.centerChanged$.subscribe(coords => {\r\n        if (self.zoomConfig.scale === 1) {\r\n          return;\r\n        }\r\n\r\n        self.setCoor(coords.x, coords.y);\r\n        self.transform(coords.x, coords.y);\r\n      });\r\n    }\r\n\r\n    zoomConfig = {\r\n      ow: 0,\r\n      oh: 0,\r\n      original_x: 0,\r\n      original_y: 0,\r\n      max_x: 0,\r\n      max_y: 0,\r\n      min_x: 0,\r\n      min_y: 0,\r\n      x: 0,\r\n      y: 0,\r\n      last_x: 0,\r\n      last_y: 0,\r\n      scale: 1,\r\n      base: 1,\r\n    };\r\n\r\n    toggleZoomControls () {\r\n      this.zoomControlsState = this.zoomControlsState === 'shown' ? 'hidden' : 'shown';\r\n    }\r\n  \r\n    zoomIn () {\r\n      this.zoomConfig.scale += 1;\r\n  \r\n      if (this.zoomConfig.scale > 1) {\r\n        this.zoomAreaProvider.notifyScrollState(this.zoomAreaProvider.SCROLL_STATE.COLAPSED);\r\n      }\r\n  \r\n      if (this.zoomConfig.scale > 4) {\r\n        this.zoomConfig.scale = 4;\r\n      }\r\n\r\n      this.transform();\r\n      this.afterZoomIn.emit();\r\n    }\r\n  \r\n    zoomOut (reset?) {\r\n      if (!this.zoomRootElement) {\r\n        return;\r\n      }\r\n  \r\n      this.zoomConfig.scale -= 1;\r\n  \r\n      if (this.zoomConfig.scale < 1) {\r\n        this.zoomConfig.scale = 1;\r\n      }\r\n  \r\n      if (this.zoomConfig.scale === 1) {\r\n        reset = true;\r\n        this.zoomAreaProvider.notifyScrollState(this.zoomAreaProvider.SCROLL_STATE.NORMAL);\r\n      }\r\n  \r\n      reset ? this.transform(0.1, 0.1) : this.transform();\r\n  \r\n      this.afterZoomOut.emit();\r\n    }\r\n  \r\n    zoomReset () {\r\n      this.zoomConfig.scale = 1;\r\n      if (this.content && this.content.scrollTop) {\r\n        this.content.scrollTop = 0;\r\n      }\r\n      this.zoomOut(true);\r\n    }\r\n  \r\n    private _pinchZoom(elm: HTMLElement, content: Content): void {\r\n      this.zoomRootElement = elm;\r\n      this.gesture = new Gesture(this.zoomRootElement);\r\n  \r\n      for (let i = 0; i < elm.children.length; i++) {\r\n        let c = <HTMLElement>elm.children.item(i);\r\n        this.zoomConfig.ow = c.offsetWidth;\r\n        this.zoomConfig.oh += c.offsetHeight;\r\n      }\r\n  \r\n      this.zoomConfig.original_x = content.contentWidth - this.zoomConfig.ow;\r\n      this.zoomConfig.original_y = content.contentHeight - this.zoomConfig.oh;\r\n      this.zoomConfig.max_x = this.zoomConfig.original_x;\r\n      this.zoomConfig.max_y = this.zoomConfig.original_y;\r\n      this.zoomConfig.base = this.zoomConfig.scale;\r\n  \r\n      this.gesture.listen();\r\n      this.gesture.on('pan', this.onPan.bind(this));\r\n      this.gesture.on('panend', this.onPanend.bind(this));\r\n      this.gesture.on('pancancel',this. onPanend.bind(this));\r\n      this.gesture.on('tap', this.onTap.bind(this));\r\n      this.gesture.on('pinch', this.onPinch.bind(this));\r\n      this.gesture.on('pinchend', this.onPinchend.bind(this));\r\n      this.gesture.on('pinchcancel', this.onPinchend.bind(this));\r\n    }\r\n  \r\n    onPan(ev) {\r\n      if (this.zoomConfig.scale === 1) {\r\n        return;\r\n      }\r\n      \r\n      this.setCoor(ev.deltaX, ev.deltaY);\r\n      this.transform();\r\n    }\r\n  \r\n    onPanend() {\r\n      this.zoomConfig.last_x = this.zoomConfig.x;\r\n      this.zoomConfig.last_y = this.zoomConfig.y;\r\n    }\r\n  \r\n    onTap(ev) {\r\n      if (ev && ev.tapCount > 1) {\r\n        let reset = false;\r\n        this.zoomConfig.scale += .5;\r\n        if (this.zoomConfig.scale > 2) {\r\n          this.zoomConfig.scale = 1;\r\n          reset = true;\r\n        }\r\n  \r\n        this.setBounds();\r\n        reset ? this.transform(this.zoomConfig.max_x/2, this.zoomConfig.max_y/2) : this.transform();\r\n      }\r\n    }\r\n  \r\n    onPinch(ev) {\r\n      this.zoomConfig.scale = this.zoomConfig.base + (ev.scale * this.zoomConfig.scale - this.zoomConfig.scale)/this.zoomConfig.scale\r\n      this.setBounds();\r\n      this.transform();\r\n    }\r\n  \r\n    onPinchend(ev) {\r\n      if (this.zoomConfig.scale > 4) {\r\n        this.zoomConfig.scale = 4;\r\n      }\r\n  \r\n      if (this.zoomConfig.scale < 1) {\r\n        this.zoomConfig.scale = 1;\r\n      }\r\n  \r\n      this.zoomConfig.base = this.zoomConfig.scale;\r\n      this.setBounds();\r\n      this.transform(); \r\n    }\r\n  \r\n    setBounds() {\r\n      let scaled_x = Math.ceil((this.zoomRootElement.offsetWidth * this.zoomConfig.scale - this.zoomRootElement.offsetWidth) / 2);\r\n      let scaled_y = Math.ceil((this.zoomRootElement.offsetHeight * this.zoomConfig.scale - this.zoomRootElement.offsetHeight) / 2);\r\n  \r\n      let overflow_x = Math.ceil(this.zoomConfig.original_x * this.zoomConfig.scale - this.zoomConfig.original_x);\r\n      let overflow_y = Math.ceil(this.zoomConfig.oh * this.zoomConfig.scale - this.zoomConfig.oh);\r\n  \r\n      this.zoomConfig.max_x = this.zoomConfig.original_x - scaled_x + overflow_x;\r\n      this.zoomConfig.min_x = 0 + scaled_x;\r\n  \r\n      this.zoomConfig.max_y = this.zoomConfig.original_y + scaled_y - overflow_y;\r\n      this.zoomConfig.min_y = 0 + scaled_y;\r\n  \r\n      this.setCoor(-scaled_x, scaled_y);\r\n    }\r\n  \r\n    setCoor(xx: number, yy: number) {\r\n      const compensation = this.zoomConfig.scale === 2 ? 1.05 : (this.zoomConfig.scale / 1.25);\r\n      this.zoomConfig.x = Math.min(Math.max((this.zoomConfig.last_x + xx), this.zoomConfig.max_x * compensation), this.zoomConfig.min_x * compensation);\r\n      this.zoomConfig.y = Math.min(Math.max((this.zoomConfig.last_y + yy), this.zoomConfig.max_y * compensation), this.zoomConfig.min_y * compensation);\r\n    }\r\n  \r\n    transform(xx?: number, yy?: number) {\r\n      this.zoomRootElement.style.transform = `translate3d(${xx || this.zoomConfig.x}px, ${yy || this.zoomConfig.y}px, 0) scale3d(${this.zoomConfig.scale}, ${this.zoomConfig.scale}, 1)`;\r\n    }\r\n}\r\n"]}